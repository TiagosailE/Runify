<div class="min-h-screen bg-[#F5F5F5] dark:bg-[#1a1a1a] pb-24">
  
  <%= render 'shared/header' %>

  <main class="px-6 py-6 space-y-6">
    
    <section>
      <div class="bg-gradient-to-r from-teal-500 to-teal-600 rounded-2xl p-6 text-white shadow-lg">
        <h2 class="text-2xl font-bold mb-2"><%= @squad.name %></h2>
        <% if @squad.description.present? %>
          <p class="text-sm opacity-90 mb-3"><%= @squad.description %></p>
        <% end %>
        
        <div class="flex items-center gap-4 text-sm">
          <span><i class="fas fa-users mr-1"></i><%= @squad.users.count %> membros</span>
          <% if @squad.challenge_end %>
            <span><i class="fas fa-calendar mr-1"></i>Termina <%= @squad.challenge_end.strftime('%d/%m/%Y') %></span>
          <% else %>
            <span><i class="fas fa-infinity mr-1"></i>Infinito</span>
          <% end %>
        </div>

        <div class="mt-4 pt-4 border-t border-white/20">
          <p class="text-xs opacity-75 mb-2">Código do Pacer</p>
          <div class="flex items-center gap-2">
            <code class="bg-white/20 px-4 py-2 rounded-lg font-mono text-lg font-bold tracking-wider"><%= @squad.squad_code %></code>
            <button onclick="navigator.clipboard.writeText('<%= @squad.squad_code %>'); alert('Código copiado!')" class="bg-white/20 hover:bg-white/30 px-3 py-2 rounded-lg transition-all">
              <i class="fas fa-copy"></i>
            </button>
          </div>
        </div>
      </div>
    </section>

    <section>
      <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4">
        <i class="fas fa-trophy text-[#FF6A3D] mr-2"></i>
        Ranking
      </h3>

      <div class="space-y-3">
        <% @leaderboard.each_with_index do |member, index| %>
          <div class="relative bg-white dark:bg-[#2d3748] rounded-2xl p-5 shadow-sm <%= 'ring-2 ring-teal-500' if member.user == current_user %>">
            
            <% if index < 3 %>
              <div class="absolute top-3 left-3">
                <% medal_colors = ['#FFD700', '#C0C0C0', '#CD7F32'] %>
                <div class="w-8 h-8 rounded-full flex items-center justify-center" style="background: <%= medal_colors[index] %>">
                  <span class="text-white font-bold text-sm"><%= index + 1 %>º</span>
                </div>
              </div>
            <% else %>
              <div class="absolute top-3 left-3">
                <div class="w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center">
                  <span class="text-gray-600 dark:text-gray-400 font-bold text-sm"><%= index + 1 %>º</span>
                </div>
              </div>
            <% end %>

            <div class="flex items-center gap-4 ml-10">
              
              <div class="relative">
                <div class="w-16 h-16 rounded-full overflow-hidden border-4 <%= member.border_color %> shadow-lg">
                  <img src="<%= member.user.avatar_url %>" alt="<%= member.user.username %>" class="w-full h-full object-cover">
                </div>
                <div class="absolute -bottom-1 -right-1 bg-teal-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center border-2 border-white dark:border-gray-800">
                  <%= member.level %>
                </div>
              </div>

              <div class="flex-1">
                <div class="flex items-center gap-2 mb-1">
                  <h4 class="font-bold text-gray-900 dark:text-white">
                    <%= member.user.username %>
                  </h4>
                  <% if member.user == current_user %>
                    <span class="text-xs bg-teal-100 dark:bg-teal-900 text-teal-700 dark:text-teal-300 px-2 py-0.5 rounded-full font-medium">Você</span>
                  <% end %>
                </div>
                <p class="text-sm text-gray-500 dark:text-gray-400"><%= member.rank_title %></p>
                
                <div class="mt-2 flex items-center gap-2">
                  <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden">
                    <div class="bg-gradient-to-r from-teal-400 to-teal-500 h-2 rounded-full transition-all" style="width: <%= member.xp_progress_percentage %>%"></div>
                  </div>
                  <span class="text-xs text-gray-500 dark:text-gray-400 font-medium"><%= member.xp_progress_percentage %>%</span>
                </div>
              </div>

              <div class="text-right">
                <p class="text-2xl font-bold text-gray-900 dark:text-white"><%= member.experience_points %></p>
                <p class="text-xs text-gray-500 dark:text-gray-400">XP</p>
                <% if member.streak > 0 %>
                  <div class="mt-1 inline-flex items-center gap-1 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 px-2 py-0.5 rounded-full">
                    <i class="fas fa-fire text-xs"></i>
                    <span class="text-xs font-bold"><%= member.streak %></span>
                  </div>
                <% end %>
              </div>

            </div>
          </div>
        <% end %>
      </div>
    </section>

    <% if @squad.owner == current_user %>
      <section>
        <div class="bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-2xl p-4 text-white shadow-lg">
          <div class="flex items-center gap-2">
            <i class="fas fa-shield-alt text-2xl"></i>
            <p class="font-semibold">Você é o administrador deste Pacer</p>
          </div>
        </div>
      </section>
    <% else %>
      <%= button_to "Sair do Pacer", leave_pacer_path(@squad), 
          method: :delete,
          data: { confirm: 'Tem certeza que deseja sair deste Pacer?' },
          class: "w-full bg-red-500 hover:bg-red-600 text-white font-semibold py-4 px-4 rounded-2xl transition-all shadow-lg" %>
    <% end %>

  </main>

  <%= render 'shared/footer' %>

</div>